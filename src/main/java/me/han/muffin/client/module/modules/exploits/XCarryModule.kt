package me.han.muffin.client.module.modules.exploits

import me.han.muffin.client.core.Globals
import me.han.muffin.client.event.EventStageable
import me.han.muffin.client.event.events.network.PacketEvent
import me.han.muffin.client.module.Module
import me.han.muffin.client.utils.extensions.mixin.netty.windowId
import me.han.muffin.client.value.Value
import net.minecraft.network.play.client.CPacketCloseWindow
import team.stiff.pomelo.impl.annotated.handler.annotation.Listener

internal object XCarryModule : Module("XCarry", Category.EXPLOITS, "The crafting slots in your inventory become extra storage space.") {
    private val forceCancel = Value(false, "ForceCancel")

    init {
        addSettings(forceCancel)
    }

    @Listener
    private fun onPacketSend(event: PacketEvent.Send) {
        if (event.stage != EventStageable.EventStage.PRE || event.packet !is CPacketCloseWindow) return
        if (event.packet.windowId == Globals.mc.player.inventoryContainer.windowId || forceCancel.value) event.cancel()
    }

    /*
    @Listener
    private fun onPacketSend(event: PacketEvent.Send) {
        if (event.stage == EventStageable.EventStage.PRE) {

            if (!forceCancel.value) if (Globals.mc.currentScreen is GuiHopper ||
                    Globals.mc.currentScreen is GuiChest ||
                    Globals.mc.currentScreen is GuiDispenser ||
                    Globals.mc.currentScreen is GuiShulkerBox)
                return

            if (event.packet is CPacketCloseWindow)
                event.cancel()

        }
    }
     */

}